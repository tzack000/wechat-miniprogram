# course-booking Specification

## Purpose

提供课程预约功能，用户可以浏览课程、查看教练信息，并预约由指定教练指导的课程。

## ADDED Requirements

### Requirement: 教练列表展示
系统 SHALL 提供教练列表页面，展示所有可用教练信息。

#### Scenario: 用户浏览教练列表
- **WHEN** 用户进入教练列表页面
- **THEN** 系统展示所有启用状态的教练
- **AND** 每个教练显示头像、姓名、职称、擅长领域
- **AND** 支持按擅长领域筛选

#### Scenario: 教练列表为空
- **WHEN** 系统中没有可用教练
- **THEN** 显示"暂无教练信息"提示

### Requirement: 教练详情查看
系统 SHALL 提供教练详情页面，展示教练完整信息和其开设的课程。

#### Scenario: 查看教练详情
- **WHEN** 用户点击某个教练
- **THEN** 进入教练详情页
- **AND** 展示教练头像、姓名、职称、简介、擅长领域、资质证书
- **AND** 展示该教练可授课的课程列表

#### Scenario: 从教练详情进入课程
- **GIVEN** 用户在教练详情页
- **WHEN** 用户点击某个课程
- **THEN** 进入该课程详情页
- **AND** 自动选中该教练

### Requirement: 课程列表展示
系统 SHALL 提供课程列表页面，展示所有可预约的课程。

#### Scenario: 用户浏览课程列表
- **WHEN** 用户进入课程列表页面
- **THEN** 系统展示所有启用状态的课程
- **AND** 每个课程显示名称、类型、图片、价格、时长
- **AND** 支持按课程类型筛选（瑜伽、游泳、篮球等）

#### Scenario: 课程列表为空
- **WHEN** 系统中没有可用课程
- **THEN** 显示"暂无可预约课程"提示

### Requirement: 课程详情与排期查看
系统 SHALL 提供课程详情页面，展示课程信息和可预约的排期。

#### Scenario: 查看课程详情
- **WHEN** 用户点击某个课程
- **THEN** 进入课程详情页
- **AND** 展示课程名称、类型、描述、时长、价格、图片
- **AND** 展示可授课的教练列表

#### Scenario: 查看课程排期
- **WHEN** 用户在课程详情页选择日期
- **THEN** 系统展示该日期所有排期
- **AND** 每个排期显示时间、教练、剩余名额
- **AND** 有名额的排期显示为可点击
- **AND** 已满的排期显示为"已满"不可点击

#### Scenario: 按教练筛选排期
- **GIVEN** 用户在课程详情页
- **WHEN** 用户选择特定教练
- **THEN** 仅显示该教练的排期

### Requirement: 课程预约
系统 SHALL 允许已登录用户预约课程。

#### Scenario: 成功预约课程
- **GIVEN** 用户已登录
- **AND** 选择了有名额的课程排期
- **WHEN** 用户点击"立即预约"按钮
- **AND** 填写预约人信息
- **THEN** 系统创建预约记录
- **AND** 排期已预约人数加1
- **AND** 预约状态设为"已确认"
- **AND** 跳转到预约成功页面

#### Scenario: 未登录用户预约
- **GIVEN** 用户未登录
- **WHEN** 用户尝试预约课程
- **THEN** 系统提示用户先登录
- **AND** 引导用户进行微信授权登录

#### Scenario: 课程名额已满
- **GIVEN** 用户选择的排期在提交时名额已满
- **WHEN** 用户提交预约
- **THEN** 系统提示"该场次名额已满，请选择其他场次"
- **AND** 刷新排期状态

#### Scenario: 重复预约同一场次
- **GIVEN** 用户已预约某场次课程
- **WHEN** 用户尝试再次预约同一场次
- **THEN** 系统提示"您已预约该场次课程"

### Requirement: 课程预约记录管理
系统 SHALL 允许用户查看和管理自己的课程预约记录。

#### Scenario: 查看我的课程预约列表
- **WHEN** 用户进入"我的课程"页面
- **THEN** 系统展示用户所有课程预约记录
- **AND** 按时间倒序排列
- **AND** 每条记录显示课程名称、教练、预约时间、状态

#### Scenario: 查看课程预约详情
- **WHEN** 用户点击某条预约记录
- **THEN** 展示预约完整信息
- **AND** 显示取消预约按钮（如果可取消）

### Requirement: 取消课程预约
系统 SHALL 允许用户在规定时间内取消课程预约。

#### Scenario: 成功取消课程预约
- **GIVEN** 预约状态为"已确认"
- **AND** 距离课程开始时间大于设定的最小时间（如2小时）
- **WHEN** 用户点击"取消预约"
- **THEN** 系统更新预约状态为"已取消"
- **AND** 排期已预约人数减1
- **AND** 释放名额供其他用户预约

#### Scenario: 超时无法取消
- **GIVEN** 距离课程开始时间小于设定的最小时间
- **WHEN** 用户尝试取消预约
- **THEN** 系统提示"已超过可取消时间，无法取消"

### Requirement: 教练管理（管理员）
系统 SHALL 允许管理员管理教练信息。

#### Scenario: 添加新教练
- **GIVEN** 用户为管理员
- **WHEN** 管理员在管理页面添加教练
- **AND** 填写姓名、头像、职称、简介、擅长领域、资质证书
- **THEN** 系统创建新教练记录
- **AND** 教练默认为启用状态

#### Scenario: 编辑教练信息
- **GIVEN** 用户为管理员
- **WHEN** 管理员编辑教练信息
- **THEN** 系统更新教练记录

#### Scenario: 停用/启用教练
- **GIVEN** 用户为管理员
- **WHEN** 管理员停用某教练
- **THEN** 该教练不再出现在用户的教练列表中
- **AND** 该教练的未来排期自动取消

### Requirement: 课程管理（管理员）
系统 SHALL 允许管理员管理课程信息。

#### Scenario: 添加新课程
- **GIVEN** 用户为管理员
- **WHEN** 管理员在管理页面添加课程
- **AND** 填写课程名称、类型、描述、时长、价格、最大人数、图片
- **AND** 选择可授课的教练
- **THEN** 系统创建新课程记录
- **AND** 课程默认为启用状态

#### Scenario: 编辑课程信息
- **GIVEN** 用户为管理员
- **WHEN** 管理员编辑课程信息
- **THEN** 系统更新课程记录

#### Scenario: 停用/启用课程
- **GIVEN** 用户为管理员
- **WHEN** 管理员停用某课程
- **THEN** 该课程不再出现在用户的课程列表中
- **AND** 已有预约不受影响

### Requirement: 课程排期管理（管理员）
系统 SHALL 允许管理员管理课程排期。

#### Scenario: 创建课程排期
- **GIVEN** 用户为管理员
- **WHEN** 管理员为某课程创建排期
- **AND** 选择日期、时间、教练、最大人数
- **THEN** 系统创建排期记录
- **AND** 排期状态为"可预约"

#### Scenario: 取消课程排期
- **GIVEN** 用户为管理员
- **AND** 某排期存在已预约记录
- **WHEN** 管理员取消该排期
- **THEN** 排期状态更新为"已取消"
- **AND** 所有相关预约状态更新为"已取消"

### Requirement: 课程预约管理（管理员）
系统 SHALL 允许管理员查看和管理所有课程预约记录。

#### Scenario: 查看所有课程预约
- **GIVEN** 用户为管理员
- **WHEN** 管理员进入课程预约管理页面
- **THEN** 系统展示所有课程预约记录
- **AND** 支持按课程、教练、日期、状态筛选

#### Scenario: 取消用户课程预约
- **GIVEN** 用户为管理员
- **WHEN** 管理员取消某条预约
- **THEN** 预约状态更新为"已取消"
- **AND** 排期已预约人数减1
