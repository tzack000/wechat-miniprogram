# 课程预约功能快速启动指南

## 🚀 5分钟快速部署

### 步骤1：部署云函数（2分钟）

在微信开发者工具中，依次右键点击以下目录并选择"上传并部署：云端安装依赖"：

```
✅ cloudfunctions/coach/
✅ cloudfunctions/course/
✅ cloudfunctions/initCourseData/
```

等待全部部署完成（状态变为绿色✓）

### 步骤2：创建数据库集合（1分钟）

在云开发控制台 → 数据库，点击"+"创建以下4个集合：

```
✅ coaches
✅ courses
✅ course_schedules
✅ course_bookings
```

**快速权限设置**：
- `coaches`, `courses`, `course_schedules`：读=true, 写=false
- `course_bookings`：读=`doc._openid == auth.openid`, 写=`doc._openid == auth.openid`

### 步骤3：初始化数据（1分钟）

在云开发控制台 → 云函数 → initCourseData：

1. 点击"测试"按钮
2. 输入测试参数：
```json
{
  "action": "init",
  "clear": false
}
```
3. 点击"调用"
4. 等待返回成功消息

**预期结果**：
- 5名教练
- 8门课程
- 约168个排期（每门课程×7天×3时段）

### 步骤4：验证部署（1分钟）

在微信开发者工具中：

1. 点击"编译"
2. 点击首页的"课程预约"
3. 应该能看到课程列表

✅ 部署完成！现在可以开始测试了。

## 🧪 快速测试流程

### 测试1：基础浏览（30秒）
```
首页 → 课程预约 → 查看课程列表
✓ 显示8门课程
✓ 可以按类型筛选
```

### 测试2：查看详情（30秒）
```
点击任意课程 → 查看详情
✓ 显示课程信息
✓ 显示教练
✓ 显示未来7天排期
```

### 测试3：预约课程（1分钟）
```
选择一个排期 → 点击预约 → 填写信息 → 提交
✓ 预约成功
✓ 跳转到"我的课程"
✓ 显示预约记录
```

### 测试4：取消预约（30秒）
```
我的课程 → 点击"取消预约"
✓ 预约状态变为"已取消"
✓ 排期名额+1
```

## ✅ 验收检查表

- [ ] 云函数部署成功（coach, course, initCourseData）
- [ ] 4个集合创建成功
- [ ] 数据初始化成功（查看集合有数据）
- [ ] 可以浏览课程列表
- [ ] 可以查看课程详情和排期
- [ ] 可以成功预约课程
- [ ] 可以查看"我的课程"
- [ ] 可以取消预约

全部通过 = 部署成功！ 🎉

## 🆘 快速问题解决

### 问题：看不到课程列表
**解决**：
1. 检查 course 云函数是否部署成功
2. 检查 courses 集合是否有数据
3. 查看控制台是否有错误信息

### 问题：预约失败
**解决**：
1. 确认已登录（点击个人中心查看）
2. 检查排期是否有名额
3. 查看 course 云函数日志

### 问题：数据初始化失败
**解决**：
1. 检查 initCourseData 云函数日志
2. 确认集合已创建
3. 尝试设置 `"clear": true` 清空后重试

## 📞 需要帮助？

查看完整部署指南：`DEPLOYMENT_GUIDE.md`
查看实施总结：`IMPLEMENTATION.md`
